---
import * as Plot from "@observablehq/plot";
import { JSDOM } from "jsdom";

const { options } = Astro.props;
const jsdom = new JSDOM();
const plottyplot = Plot.plot({
  ...options,
  document: jsdom.window._document,
});
---

<astro-figure data-plot-options={JSON.stringify(options)}>
  <Fragment set:html={plottyplot.outerHTML} />
</astro-figure>

<script>
  // import * as Plot from "@observablehq/plot";
  class AstroFigure extends HTMLElement {
    constructor() {
      super();
      // this.innerHTML = "";
      // this.appendChild(
      //   Plot.plot({
      //     ...JSON.parse(this.dataset.plotOptions || ""),
      //     tip: "x",
      //   })
      // );
    }
  }
  customElements.define("astro-figure", AstroFigure);
</script>
